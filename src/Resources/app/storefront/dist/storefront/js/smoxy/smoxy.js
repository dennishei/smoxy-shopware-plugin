(()=>{"use strict";var t={156:t=>{var e=function(t){var e;return!!t&&"object"==typeof t&&"[object RegExp]"!==(e=Object.prototype.toString.call(t))&&"[object Date]"!==e&&t.$$typeof!==i},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(t,e){return!1!==e.clone&&e.isMergeableObject(t)?a(Array.isArray(t)?[]:{},t,e):t}function r(t,e,i){return t.concat(e).map(function(t){return n(t,i)})}function s(t){return Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[])}function o(t,e){try{return e in t}catch(t){return!1}}function a(t,i,c){(c=c||{}).arrayMerge=c.arrayMerge||r,c.isMergeableObject=c.isMergeableObject||e,c.cloneUnlessOtherwiseSpecified=n;var l,h,u=Array.isArray(i);return u!==Array.isArray(t)?n(i,c):u?c.arrayMerge(t,i,c):(h={},(l=c).isMergeableObject(t)&&s(t).forEach(function(e){h[e]=n(t[e],l)}),s(i).forEach(function(e){(!o(t,e)||Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))&&(o(t,e)&&l.isMergeableObject(i[e])?h[e]=(function(t,e){if(!e.customMerge)return a;var i=e.customMerge(t);return"function"==typeof i?i:a})(e,l)(t[e],i[e],l):h[e]=n(i[e],l))}),h)}a.all=function(t,e){if(!Array.isArray(t))throw Error("first argument should be an array");return t.reduce(function(t,i){return a(t,i,e)},{})},t.exports=a}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var n=i(156),r=i.n(n);class s{static ucFirst(t){return t.charAt(0).toUpperCase()+t.slice(1)}static lcFirst(t){return t.charAt(0).toLowerCase()+t.slice(1)}static toDashCase(t){return t.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(t,e){let i=s.toUpperCamelCase(t,e);return s.lcFirst(i)}static toUpperCamelCase(t,e){return e?t.split(e).map(t=>s.ucFirst(t.toLowerCase())).join(""):s.ucFirst(t.toLowerCase())}static parsePrimitive(t){try{return/^\d+(.|,)\d+$/.test(t)&&(t=t.replace(",",".")),JSON.parse(t)}catch(e){return t.toString()}}}class o{constructor(t=document){this._el=t,t.$emitter=this,this._listeners=[]}publish(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new CustomEvent(t,{detail:e,cancelable:i});return this.el.dispatchEvent(n),n}subscribe(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this,r=t.split("."),s=i.scope?e.bind(i.scope):e;if(i.once&&!0===i.once){let e=s;s=function(i){n.unsubscribe(t),e(i)}}return this.el.addEventListener(r[0],s),this.listeners.push({splitEventName:r,opts:i,cb:s}),!0}unsubscribe(t){let e=t.split(".");return this.listeners=this.listeners.reduce((t,i)=>([...i.splitEventName].sort().toString()===e.sort().toString()?this.el.removeEventListener(i.splitEventName[0],i.cb):t.push(i),t),[]),!0}reset(){return this.listeners.forEach(t=>{this.el.removeEventListener(t.splitEventName[0],t.cb)}),this.listeners=[],!0}get el(){return this._el}set el(t){this._el=t}get listeners(){return this._listeners}set listeners(t){this._listeners=t}}class a{constructor(t,e={},i=!1){if(!(t instanceof Node))throw Error("There is no valid element given.");this.el=t,this.$emitter=new o(this.el),this._pluginName=this._getPluginName(i),this.options=this._mergeOptions(e),this._initialized=!1,this._registerInstance(),this._init()}init(){throw Error(`The "init" method for the plugin "${this._pluginName}" is not defined.`)}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(t){let e=[this.constructor.options,this.options,t];return e.push(this._getConfigFromDataAttribute()),e.push(this._getOptionsFromDataAttribute()),r().all(e.filter(t=>t instanceof Object&&!(t instanceof Array)).map(t=>t||{}))}_getConfigFromDataAttribute(){let t={};if("function"!=typeof this.el.getAttribute)return t;let e=s.toDashCase(this._pluginName),i=this.el.getAttribute(`data-${e}-config`);return i?window.PluginConfigManager.get(this._pluginName,i):t}_getOptionsFromDataAttribute(){let t={};if("function"!=typeof this.el.getAttribute)return t;let e=s.toDashCase(this._pluginName),i=this.el.getAttribute(`data-${e}-options`);if(i)try{return JSON.parse(i)}catch(t){console.error(`The data attribute "data-${e}-options" could not be parsed to json: ${t.message}`)}return t}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(t){return t||(t=this.constructor.name),t}}class c extends a{static #t=this.options={overlayUrl:"/account/overlay",configUrl:"/account/overlay/config",triggerSelector:"[data-account-overlay-trigger]",contentSelector:"[data-account-overlay-content]",cacheTimeout:3e5,loadOnHover:!0,loadOnClick:!1};init(){this.cache=new Map,this.isLoading=!1,this.isInitialized=!1,this.hideTimeout=null,this.configLoaded=!1,this.loadConfig().then(()=>{this.registerEvents()})}async loadConfig(){try{let t=await fetch(this.options.configUrl,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(t.ok){let e=await t.json();this.options.cacheTimeout=e.cacheTimeout||this.options.cacheTimeout,this.options.loadOnHover=void 0!==e.loadOnHover?e.loadOnHover:this.options.loadOnHover,this.options.loadOnClick=void 0!==e.loadOnClick?e.loadOnClick:this.options.loadOnClick,this.options.enableCaching=void 0===e.enableCaching||e.enableCaching,this.configLoaded=!0}}catch(t){console.error("SMOXY AccountOverlay: Failed to load configuration",t)}}registerEvents(){let t=document.querySelector(this.options.triggerSelector),e=document.querySelector(this.options.contentSelector);t&&e&&(this.trigger=t,this.content=e,this.dropdown=this.trigger.nextElementSibling,this.options.loadOnHover&&(this.trigger.addEventListener("mouseenter",this.onTriggerHover.bind(this)),this.trigger.addEventListener("mouseleave",this.onMouseLeave.bind(this)),this.dropdown&&(this.dropdown.addEventListener("mouseenter",this.onDropdownEnter.bind(this)),this.dropdown.addEventListener("mouseleave",this.onDropdownLeave.bind(this)))),this.options.loadOnClick&&this.trigger.addEventListener("click",this.onTriggerClick.bind(this)),document.addEventListener("customer-login",this.clearCache.bind(this)),document.addEventListener("customer-logout",this.clearCache.bind(this)))}onTriggerHover(t){this.showDropdown(),this.isInitialized||this.isLoading||this.loadOverlayContent()}onTriggerClick(t){this.isInitialized||this.loadOverlayContent()}onMouseLeave(t){this.hideTimeout=setTimeout(()=>{this.hideDropdown()},200)}onDropdownEnter(t){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}onDropdownLeave(t){this.hideDropdown()}showDropdown(){this.dropdown&&(this.dropdown.classList.add("show"),this.trigger.setAttribute("aria-expanded","true"))}hideDropdown(){this.dropdown&&(this.dropdown.classList.remove("show"),this.trigger.setAttribute("aria-expanded","false")),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}async loadOverlayContent(){if(this.isLoading)return;let t="account-overlay",e=this.getCachedData(t);if(e){this.renderContent(e),this.isInitialized=!0;return}this.isLoading=!0;try{let e=await fetch(this.options.overlayUrl,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);let i=await e.json();this.setCachedData(t,i),this.renderContent(i),this.isInitialized=!0}catch(t){console.error("SMOXY AccountOverlay: Failed to load content",t),this.renderError()}finally{this.isLoading=!1}}renderContent(t){let e="";e=t.isLoggedIn?`
                <div class="account-menu">
                    <div class="dropdown-header account-menu-header">
                        Ihr Konto
                    </div>
                    <div class="account-menu-links">
                        <div class="header-account-menu">
                            <div class="card account-menu-inner">
                                <nav class="list-group list-group-flush account-aside-list-group">
                                    <a href="${t.links.overview}" 
                                       title="\xdcbersicht" 
                                       class="list-group-item list-group-item-action account-aside-item">
                                        \xdcbersicht
                                    </a>
                                    <a href="${t.links.profile}" 
                                       title="Pers\xf6nliches Profil" 
                                       class="list-group-item list-group-item-action account-aside-item">
                                        Pers\xf6nliches Profil
                                    </a>
                                    <a href="${t.links.addresses}" 
                                       title="Adressen" 
                                       class="list-group-item list-group-item-action account-aside-item">
                                        Adressen
                                    </a>
                                    <a href="${t.links.orders}" 
                                       title="Bestellungen" 
                                       class="list-group-item list-group-item-action account-aside-item">
                                        Bestellungen
                                    </a>
                                </nav>
                                <div class="card-footer account-aside-footer">
                                    <a href="${t.links.logout}" class="btn btn-link account-aside-btn">
                                        Abmelden
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `:`
                <div class="account-menu">
                    <div class="account-menu-login">
                        <a href="${t.links.login}" 
                           title="Anmelden" 
                           class="btn btn-primary account-menu-login-button">
                            Anmelden
                        </a>
                        <div class="account-menu-register">
                            oder <a href="${t.links.register}" title="Registrieren">registrieren</a>
                        </div>
                    </div>
                </div>
            `,this.content.innerHTML=e,this.content.classList.add("account-overlay-loaded"),window.PluginManager.initializePlugins(),document.dispatchEvent(new CustomEvent("account-overlay-loaded",{detail:{content:this.content}}))}renderError(){this.content.innerHTML=`
            <div class="account-overlay-error">
                <p>Fehler beim Laden des Account-Men\xfcs. Bitte versuchen Sie es sp\xe4ter erneut.</p>
                <a href="/account/login" class="btn btn-primary">Zur Anmeldung</a>
            </div>
        `,this.content.classList.add("account-overlay-error")}getCachedData(t){if(!this.options.enableCaching)return null;let e=this.cache.get(t);return e&&Date.now()-e.timestamp<this.options.cacheTimeout?e.data:null}setCachedData(t,e){this.options.enableCaching&&this.cache.set(t,{data:e,timestamp:Date.now()})}clearCache(){this.cache.clear(),this.isInitialized=!1,this.content.classList.remove("account-overlay-loaded")}}let l=window.PluginManager;console.log("Smoxy: Registering AccountOverlay plugin"),l.register("AccountOverlay",c,"[data-account-overlay]"),console.log("Smoxy: Plugin registered successfully")})();